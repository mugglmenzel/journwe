@(cat:  models.category.Category)

@import models.category.Category
@import models.dao.category.CategoryHierarchyDAO
@import models.dao.category.CategoryDAO
@import play.libs.Json

@main(Messages("journwe.subtitle")) { } {

    <div class="page-header page-header-round">
        <h1>
            Category @if(Category.SUPER_CATEGORY.equals(cat.getId)){Overview}else{@cat.getName}
            <small>@Messages("journwe.subtitle")</small>
        </h1>
    </div>


    @defining(new CategoryHierarchyDAO){ catHierDAO =>
        <div class="nav-category visible-lg hidden" style="">
            <ul id="nav-category-list" class="nav nav-pills nav-stacked">
                @defining(new CategoryDAO().get(catHierDAO.getSuperCategoryId(cat.getId))){ catSuper => <li><a href="@if(Category.SUPER_CATEGORY.equals(catSuper.getId)){@html.routes.ApplicationController.categoryOverview()}else{@html.routes.ApplicationController.categoryIndex(catSuper.getId)}"><i class="fa fa-arrow-circle-up" title="@if(Category.SUPER_CATEGORY.equals(catSuper.getId)){Overview}else{@catSuper.getName}"></i> </a></li>}
                <li><a href="#subcategories"><i class="fa fa-arrow-circle-down" title="Sub-Categories"></i></a></li>
                <li><a href="#inspirations"><i class="fa fa-lightbulb-o" title="Inspirations"></i></a></li>
                <li><a href="#publicadventures"><i class="fa fa-bullhorn" title="Public JournWes"></i></a></li>
            </ul>
        </div>
    }

    @if(!"".equals(cat.getHTMLDescription())){
        <div class="jrn-container" style="margin-top: -20px; margin-bottom: 70px;">
            <p class="lead pull-left">
                @Html(cat.getHTMLDescription())
            </p>
        </div>
    }

    @defining(new CategoryDAO()){ catDAO =>
    <div class="jrn-container jrn-subcategory">

        <h2 id="subcategories"><i class="fa fa-arrow-down"></i> @Messages("admin.category.subcategories") (@catDAO.countSubcategory(cat.getId))</h2>
        <div style="">
            <div id="categories-list" style="font-size: 20pt;">
                <i class="fa fa-spin icon-journwe"></i>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>
    <script type="text/x-tmpl" id="category-template">
        <div data-id="{%=o.id%}" class="polaroid" style="position: relative; float: left; width: 20%;">
            <a href="{%=o.link%}">
                <img style="margin: 0px; width: 100%;" src="{% if(o.image == null) { %}{%=String('http://www.placehold.it/204x204/EFEFEF/AAAAAA&text=no+image')%}{% } else { %}{%=String('http://i.embed.ly/1/image/crop?width=204&height=204&url=' + o.image + '&key=2c8ef5b200c6468f9f863bc75c46009f')%}{% } %}">
                <div style="position: absolute; bottom: 0px; right: 0px; left: 0px; top: 0px; padding: 0px;">
                    <img class="img-rounded" src="@routes.Assets.at("img/overlay/category_overlay.png")" style="width: 100%; height: 100%; margin: 0px;">
                </div>
            </a>
            <div style="background-color: rgba(255,255,255,0.6); position: absolute; bottom: 0px; left: 0px; right: 0px; padding: 2px;">
                <div style="line-height: 20px;"><h4><a href="{%=o.link%}">{%=o.name%} <span class="badge badge-info">{%=o.count%}</span></a></h4></div>
            </div>
        </div>
    </script>


    <div class="jrn-container">
        <h2 id="inspirations"><i class="fa fa-lightbulb-o"></i> @Messages("inspiration.text") (@catDAO.countInspirationsByCategory(cat.getId))<div class="pull-right"><button id="inspirations-public-button-refresh" class="btn btn-success"><i class="fa fa-refresh"></i></button></div></h2>
        <div style="">
            <div id="inspirations-public-list" class="text-center"><i class="fa fa-spin icon-journwe" style="font-size: 50px; margin-bottom: 20px;"></i></div>
            <div class="clearfix"></div>
            <div class="text-center"><button id="inspirations-public-load-more-button" class="btn btn-default btn-block"> @Messages("adventure.general.button.more") </button></div>
        </div>
        <div style="height: 400px; margin-top: 10px;">
            <div id="inspirations-places-map" style="width: 100%; height: 100%"></div>
        </div>
    </div>

    }
    <script type="text/x-tmpl" id="inspiration-public-template">
        <div data-id="{%=o.id%}" class="polaroid" style="position: relative; float: left; width: 25%;">
            <a href="{%=o.link%}"><img class="img-rounded" style="margin: 0px; width: 100%;" src="{% if(o.image == null) { %}{%=String('http://www.placehold.it/204x204/EFEFEF/AAAAAA&text=no+image')%}{% } else { %}{%=String('http://i.embed.ly/1/image/crop?width=204&height=204&url=' + o.image + '&key=2c8ef5b200c6468f9f863bc75c46009f')%}{% } %}"></a>
            <div style="background-color: rgba(255,255,255,0.6); position: absolute; bottom: 0px; left: 0px; right: 0px; padding: 2px;">
                <div class="overlay text-center" style="line-height: 20px; display: none;"><h4><a href="{%=o.link%}">{%=o.name%}</a></h4></div>
            </div>
        </div>
    </script>

    <div class="jrn-container">
        <h2 id="publicadventures"><i class="fa fa-bullhorn"></i> @Messages("public.adventures") <div class="pull-right"><button id="adventures-public-button-refresh" class="btn btn-success"><i class="fa fa-refresh"></i></button></div></h2>

        <div style="">
            <div id="adventures-public-list" class="text-center"><i class="fa fa-spin icon-journwe" style="font-size: 50px; margin-bottom: 20px;"></i></div>
            <div class="clearfix"></div>
            <div class="text-center"><button id="adventures-public-load-more-button" class="btn btn-default btn-block"> @Messages("adventure.general.button.more") </button></div>
        </div>
        <div style="height: 400px; margin-top: 10px;">
            <div id="adventures-places-map" style="width: 100%; height: 100%"></div>
        </div>
    </div>
    <script type="text/x-tmpl" id="adventure-public-template">
        <div data-id="{%=o.id%}" class="polaroid" style="position: relative; float: left; width: 20%;">
            <a href="{%=o.link%}"><img class="img-rounded" style="margin: 0px; width: 100%;" src="{% if(o.image == null) { %}{%=String('http://www.placehold.it/204x204/EFEFEF/AAAAAA&text=no+image')%}{% } else { %}{%=String('http://i.embed.ly/1/image/crop?width=204&height=204&url=' + o.image + '&key=2c8ef5b200c6468f9f863bc75c46009f')%}{% } %}"></a>
            <div style="background-color: rgba(255,255,255,0.6); position: absolute; bottom: 0px; left: 0px; right: 0px; padding: 2px;">
                <div style="line-height: 20px;"><h4><a href="{%=o.link%}">{%=o.name%}</a></h4></div>
                <div class="overlay text-center" style="display: none;">
                    <span class="label" style="background-color: rgba(184, 246, 145, 0.5);" title="Place"><i class="icon-globe"></i> {% if(o.favoritePlace != null) { %} {%=o.favoritePlace.address.substr(0,3).toUpperCase()%} {% } else { %} ? {% } %}</span>
                    <span class="label" style="background-color: rgba(235, 114, 104, 0.5);" title="Adventurers"><i class="icon-group"></i> {%=o.peopleCount%}</span>
                    <span class="label" style="background-color: rgba(152, 229, 251, 0.5);" title="Time"><i class="icon-calendar"></i> {% if(o.favoriteTime != null) { %} {%=formatDateShort(o.favoriteTime.startDate)%} {% } else { %} ? {% } %}</span>
                </div>
            </div>
        </div>
    </script>

    <script type="text/javascript">
        define("categoryData", [], @{Html(Json.toJson(cat).toString())});
    </script>

    <script src="@routes.Assets.at("javascripts/indexCat.js").url" type="text/javascript"></script>
}
