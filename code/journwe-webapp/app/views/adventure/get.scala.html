@(adv: models.adventure.Adventure, ins: Inspiration, advr: models.adventure.Adventurer, active: String, timeForm: Form[models.adventure.time.TimeOption])(description: Html)

@import models.dao.AdventurerDAO
@import models.dao.UserDAO
@import com.feth.play.module.pa.PlayAuthenticate
@import play.mvc.Http

@main(adv.getName()){<a href="#" id="adventureName" data-type="text" data-pk="@adv.getId()"
                        data-url="@routes.AdventureController.saveEditable()"
                        data-original-title="Enter adventure name" data-inputclass="input-xxlarge">@adv.getName()</a><span id="index"></span>
@if(ins != null) {<small>@ins.getName()</small>} <a class="btn btn-danger pull-right" onclick="$('#leave').modal();"><i class="icon-unlink"></i> Leave</a>} {

<div id="adventure-container">
    @if(new AdventurerDAO().get(adv.getId(), new
    UserDAO().findByAuthUserIdentity(PlayAuthenticate.getUser(Http.Context.current())).getId()) != null){
    <!-- Only required for left/right tabs -->
    <div class="nav-adventure">
        <ul id="nav-adventure-list" class="nav nav-pills nav-stacked">
            <li  id="nav-adventure-index"
            @if(active == "index"){class="active"}><a href="#index" onclick="return jumpToSection('index');"><i
                class="icon-info"></i> Overview</a></li>
            <li id="nav-adventure-places"
            @if(active == "places"){class="active"}><a href="#places" onclick="return jumpToSection('places');"><i class="icon-globe"></i> Place</a></li>
            <li id="nav-adventure-adventurers"
            @if(active == "adventurers"){class="active"}><a href="#adventurers" onclick="return jumpToSection('adventurers');"><i class="icon-group"></i> Adventurers</a></li>
            <li  id="nav-adventure-time"
            @if(active == "times"){class="active"}><a href="#times" onclick="return jumpToSection('times');"><i
                class="icon-time"></i> Date &amp; Time</a></li>

            <li id="nav-adventure-messages"
            @if(active == "messages"){class="active"}><a href="#messages" onclick="return jumpToSection('messages');"><i class="icon-envelope"></i> Messages</a></li>
            <li   id="nav-adventure-todos"
            @if(active == "todos"){class="active"}><a href="#todos" onclick="return jumpToSection('todos');"><i
                class="icon-list-ol"></i> Packing List</a></li>
            <li   id="nav-adventure-files"
            @if(active == "files"){class="active"}><a href="#files" onclick="return jumpToSection('files');"><i class="icon-cloud"></i> Files</a></li>
            <li   id="nav-adventure-offers"
            @if(active == "offers"){class="active"}><a href="#offers" onclick="return jumpToSection('offers');"><i class="icon-sun"></i> Offers</a></li>
        </ul>
    </div>
    }
    <div class="row-fluid">

        <div class="span1"><i class="icon-info icon-for-adventure-title"></i></div>

        <div class="span8">

            <h2 id="index">Adventure</h2>

            <p class="pull-left">
                <img id="adventure-title-image" class="img-polaroid" style="margin-right: 20px; margin-bottom: 20px;" @if(adv.getImage == null){src="http://www.placehold.it/150x200/EFEFEF/AAAAAA&text=no+image"}else{src="http://i.embed.ly/1/image/resize?height=100&url=@adv.getImage&key=2c8ef5b200c6468f9f863bc75c46009f"}
                    ondragleave="$('#adventure-title-image').removeClass('hover'); return false;" ondragenter="$('#adventure-title-image').addClass('hover'); return false;"
                    ondrop="alert('dropped!'); $('#adventure-title-image').removeClass('hover'); event.stopPropagation(); event.preventDefault(); return false;"/>

                <div class="pull-right"><a onclick="event.stopPropagation(); $('#adventureDescription').editable('toggle');"><i class="icon-pencil"></i> Edit</a></div>

                <span id="adventureDescription" class="replace-links" data-type="textarea" data-pk="@adv.getId()"
                data-url="@routes.AdventureController.saveEditable()" data-toggle="manual" data-rows="15" data-inputclass="input-xxlarge"
                data-original-title="Enter adventure description" data-emptytext="Description of your adventure...">@Html(adv.getHTMLDescription())</span>

             </p>

            @*index(adv, ins)*@

        </div>
        <div class="span3">@{views.html.comment.widget_comment.render(adv, "index")}</div>
    </div>

    <hr/>
    <div class="row-fluid">

        <div class="span1"><i class="icon-globe icon-for-adventure-title"></i></div>

        <div class="span8">

            <h2 id="places">Place</h2>
            <p class="lead">Find a special place where your adventure takes place. Make it a beautiful spot worth exploring.</p>

            @places(adv)

        </div>
        <div class="span3">@views.html.comment.widget_comment.render(adv, "places")</div>
    </div>

    <hr/>
    <div class="row-fluid">

        <div class="span1"><i class="icon-group icon-for-adventure-title"></i></div>

        <div class="span8">

            <h2 id="adventurers">Adventurers</h2>
            <p class="lead">Experience your adventure with great people, real adventurers. Invite the greatest and book together.</p>

            @adventurers(adv, advr)
        </div>
        <div class="span3">@{views.html.comment.widget_comment.render(adv, "adventurers")}</div>
    </div>

    <hr/>
    <div class="row-fluid">
        <div class="span1"><i class="icon-calendar icon-for-adventure-title"></i></div>

        <div class="span8">

            <h2 id="times">Date &amp; Time</h2>

            @time(adv, timeForm)

        </div>
        <div class="span3">@views.html.comment.widget_comment.render(adv, "times")</div>

    </div>

    <hr/>
    <div class="row-fluid">

        <div class="span1"><i class="icon-envelope icon-for-adventure-title"></i></div>
        <div class="span8">

            <h2 id="messages">Messages</h2>
            <p class="lead">Communicate with agencies and assistants with only one email address and all adventurers stay up-to-date.</p>


        </div>
        <div class="span3">@views.html.comment.widget_comment.render(adv, "messages")</div>
    </div>



    <hr/>
    <div class="row-fluid">

        <div class="span1"><i class="icon-list-ol icon-for-adventure-title"></i></div>

        <div class="span8">


            <h2 id="todos">Todo List</h2>
            <p class="lead">Don't forget utilities at home or miss important errands. Sync with your co-adventurers.</p>

            @todos(adv, advr)

        </div>
        <div class="span3">@views.html.comment.widget_comment.render(adv, "todos")</div>
    </div>

    <hr/>
    <div class="row-fluid">

        <div class="span1"><i class="icon-cloud-upload icon-for-adventure-title"></i></div>

        <div class="span8">

            <h2 id="files">Files</h2>
            <p class="lead">There is sure some information need to be shared packed in pdfs, docs, xls, ...</p>


        </div>
        <div class="span3">@views.html.comment.widget_comment.render(adv, "files")</div>
    </div>

    <hr/>
    <div class="row-fluid">

        <div class="span1"><i class="icon-sun icon-for-adventure-title"></i></div>

        <div class="span8">

            <h2 id="offers">Offers</h2>
            <p class="lead">Check offers for your dates and places. There might be just the right sweet spot for you.</p>

            <table class="table table-striped table-hover">
                <thead>
                    <tr><th>Time Option</th><th>Place Option</th><th><i class="icon-plane"></i> Cheap Flights</th><th><i class="icon-building"></i> Cheap Hotels</th></tr>
                </thead>
                <tbody>
                    <tr><td>13.9.2013 - 19.9.2013</td><td>Berlin, Deutschland</td><td>LH 419, FRA - BER</td><td>NH Hotel Berlin City West</td></tr>
                </tbody>
            </table>

        </div>
        <div class="span3">@views.html.comment.widget_comment.render(adv, "offers")</div>
    </div>



</div>

<div id="leave" class="modal hide fade" tabindex="-1" role="dialog">
    <div class="modal-header">
        <h3>Sure, you want to leave @adv.getName()?</h3>
    </div>
    <div class="modal-footer">
        <a class="btn btn-danger" href="@routes.AdventurePeopleController.leave(adv.getId())">Leave</a> <a class="btn"
                                                                                                       data-dismiss="modal">Cancel</a>
    </div>
</div>

<script>

    $.fn.editable.defaults.mode = 'inline';
    $('document').ready(function () {

        jQuery.event.props.push('dataTransfer');
        $(window).bind('drop', function(event){event.stopPropagation(); event.preventDefault(); return false;});
        $(window).bind('dragover', function(event){event.stopPropagation(); event.preventDefault(); return false;});

        $('#adventureName').editable();

        // Replace all links with html links for certain elements
        $('.replace-links').each(function(){
            $(this).html(replaceURLWithHTMLLinks($(this).html()));
        });

        // After saving via x-editable, replace those links as well
        $.extend($.fn.editabletypes.textarea.prototype, {
            v2h: $.fn.editabletypes.textarea.prototype.value2html,
            value2html: function(foo, element){
                this.v2h.apply(this, arguments);
                $(element).html(replaceURLWithHTMLLinks($(element).html()));
            }
        });

    });



    function jumpToSection(section) {
        /*
        $('#nav-adventure-list').find('li').removeClass('active');
        $('#nav-adventure-' + section).addClass('active');
        */
        $('html, body').animate({
        scrollTop : $('#' + section).offset().top - 100
        }, 'slow');
        return false;
    }
	$('body').scrollspy({offset: 100});
    jumpToSection('@active');
</script>

}
