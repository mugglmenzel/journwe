@(adv: models.adventure.Adventure)

@import models.authorization.JournweAuthorization


@defining(new JournweAuthorization(adv.getId)){ auth =>

@if(auth.canViewPlaces()) {
<div class="clearfix">
    @if(auth.canViewFavoritePlace()) {
    <div id="places-favorite-place" class="pull-left" style="margin-bottom: 10px; margin-top: 7px;">
        <i class="fa fa-star icon-favorite-place"></i> @Messages("adventure.places.favourite") <em><span class="places-favorite-place-name">@Messages("adventure.general.nofavourite.placeholder")</span></em>
    </div>
    }

    @if(auth.canChangeVoteOnOffForPlaces()) {
    <div class="pull-right">
          <button class="btn @if(adv.getPlaceVoteOpen){btn-success} btn-set-close-place"><i class="fa fa-ok"></i> @if(adv.getPlaceVoteOpen){Close}else{Reopen}</button>
    </div>

    <div class="pull-right">
          <button class="btn btn-default btn-set-reminder-place date" data-id="@adv.getId" data-date="@adv.getPlaceVoteDeadlineFormatted" data-date-format="dd-mm-yyyy"><i class="fa fa-calendar"></i> @if(adv.getPlaceVoteDeadlineFormatted){@adv.getPlaceVoteDeadlineFormatted}else{ Set Deadline }</button>
    </div>

    <div class="pull-right btn-close-place stash hidden">
        @Messages("adventure.general.voting")
        <div class="make-switch">
            <input id="places-voting-active-switch" type="checkbox" @if(adv.getPlaceVoteOpen){checked="checked"}>
        </div>
    </div>
    }
</div>


<div id="places-list" class="">

</div>
<div class="clearfix">
    <button class="btn btn-default pull-left"><i class="fa fa-chevron-left"></i></button>
    <button class="btn btn-default pull-right"><i class="fa fa-chevron-right"></i></button>
</div>

<table  class="table table-striped table-responsive stash">
    <thead>
        <tr>
            <th>@Messages("adventure.general.favourite")</th>
            <th style="width: 120px;">@Messages("adventure.general.yourvote")</th>
            <th>@Messages("adventure.places.location")</th>
            <th class="text-center" style="width: 100px;">Group Rating</th>
            <th>@Messages("adventure.general.advvotes")</th>
            @if(auth.canEditPlaces()) {
            <th class="text-center">@Messages("adventure.general.listactions")</th>
            }
        </tr>
    </thead>
    <tbody>

    </tbody>

</table>

<div class="places-loading loader"></div>
}
@if(auth.canEditPlaces()) {
<div id="place-add-form" class="">
    <div class="input-group col-lg-8" style="margin-bottom: 10px;">
        <input type="text" placeholder="@Messages("yingyangyong.place.placeholder")" id="place-add-input" style="" class="form-control">
        <input id="place-add-comment-input" class="form-control stash" style="display: none; width: 50%;" type="text" placeholder="@Messages("adventure.comments.comment")">
        <div class="input-group-btn">
            <button id="place-add-button" class="btn btn-add btn-primary"><i class="fa fa-plus"></i></button>
        </div>
    </div>
</div>

<div style="height: 400px;">
    <div id="place-add-map" style="width: 100%; height: 100%"></div>
</div>
<div class="btn-group pull-right">
    <button class="btn btn-default btn-places-map-layers-show active" data-layers="weather"><i class="fa fa-sun-o"></i></button>
    <button class="btn btn-default btn-places-map-layers-show" data-layers="photos"><i class="fa fa-picture-o"></i></button>
</div>
}

<script type="text/x-tmpl" id="place-template">
    <div id="placeoption-item-{%=o.placeId%}" class="col-md-4 thumbnail" data-placeid="{%=o.placeId%}">
        <div class="clearfix">
            <div class="pull-left"><h3>{%=o.address%}</h3></div>
            <div class="pull-right">
                <button class="btn btn-favorite-place btn-sm {%=o.favorite?'btn-success':'btn-default'%}"><i class="fa fa-star"></i></button>
                <button class="btn btn-default btn-sm"><i class="fa fa-cog"></i></button>
                @if(auth.canEditPlaces()) {
                <button class="btn btn-delete-place btn-danger btn-sm"><i class="fa fa-trash-o"></i></button>
                }
            </div>
        </div>
        @if(auth.canVoteForPlaces()) {
        <div class="clearfix">
            <div class="rating rating-place pull-left">
                <input type="radio" class="star" id="{%=o.placeId%}-star5" name="{%=o.placeId%}-rating" value="5" data-id="{%=o.placeId%}" {% if(o.voteGravity && o.voteGravity == 5/5){ %}checked{% } %} /><label for="{%=o.placeId%}-star5" title="Rocks!"><i class="fa fa-star fa-2x"></i></label>
                <input type="radio" class="star" id="{%=o.placeId%}-star4" name="{%=o.placeId%}-rating" value="4" data-id="{%=o.placeId%}" {% if(o.voteGravity && o.voteGravity < 5/5){ %}checked{% } %} /><label for="{%=o.placeId%}-star4" title="Pretty good"><i class="fa fa-star fa-2x"></i></label>
                <input type="radio" class="star" id="{%=o.placeId%}-star3" name="{%=o.placeId%}-rating" value="3" data-id="{%=o.placeId%}" {% if(o.voteGravity && o.voteGravity < 4/5){ %}checked{% } %} /><label for="{%=o.placeId%}-star3" title="Meh"><i class="fa fa-star fa-2x"></i></label>
                <input type="radio" class="star" id="{%=o.placeId%}-star2" name="{%=o.placeId%}-rating" value="2" data-id="{%=o.placeId%}" {% if(o.voteGravity && o.voteGravity < 3/5){ %}checked{% } %} /><label for="{%=o.placeId%}-star2" title="Kinda bad"><i class="fa fa-star fa-2x"></i></label>
                <input type="radio" class="star" id="{%=o.placeId%}-star1" name="{%=o.placeId%}-rating" value="1" data-id="{%=o.placeId%}" {% if(o.voteGravity && o.voteGravity < 2/5){ %}checked{% } %} /><label for="{%=o.placeId%}-star1" title="Sucks big time"><i class="fa fa-star fa-2x"></i></label>
            </div>
        </div>
        }
        <div>
            &Oslash;{% for (var i=0; i < o.voteGroup; i++) { %} <i class="fa fa-star"></i> {% } %}
            @if(auth.canViewVotesForPlaces()) {
            <span>(
            {% for (var i in o.voteAdventurers) { for (var j in o.voteAdventurers[i]) { %} <span class="label {%=o.votePlaceLabelCSSClassMap[i]%}" title="{%=o.voteAdventurers[i][j]%}">{%=String(o.voteAdventurers[i][j]).split(/\s/)[0]%}</span> {% }} %}
            )</span>
            <div class="spacer10"></div>
            }
        </div>
        <div class="well well-sm">
            <a href="#" class="editable editable-place" data-type="textarea" data-name="placeDescription" data-pk="{%=o.placeId%}"
                data-url="@controllers.html.routes.AdventurePlaceController.savePlaceEditable(adv.getId)"
                data-emptytext="Comment...">{%=o.description%}</a>
        </div>
    </div>
</script>


}


